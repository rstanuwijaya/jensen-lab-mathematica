(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14551,        347]
NotebookOptionsPosition[     13250,        318]
NotebookOutlinePosition[     13641,        334]
CellTagsIndexPosition[     13598,        331]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"i", ",", "j"}]], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "3"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"R", "=", " ", 
     RowBox[{"(", GridBox[{
        {"1", "1", "0", "0"},
        {"0", "0", "1", "1"}
       }], ")"}]}], ")"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ArrayResample", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "2", "}"}], ",", "\"\<Bin\>\"", ",", 
           RowBox[{"Resampling", "->", "\"\<Linear\>\""}]}], "]"}], "&"}], "/@", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "//", "Transpose"}]}], 
     ")"}], "//", "MatrixForm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "\[Transpose]"}], ".", "R"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["m", 
       RowBox[{"i", ",", "j"}]], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"(", GridBox[{
         {"1", "3", "2", "1"},
         {"2", "1", "1", "2"}
        }], ")"}]}], ")"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", "\[Transpose]"}], ".", "M"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{
       "Times", ",", " ", "M", ",", " ", "R", ",", " ", "1", ",", "1"}], 
       "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"R", "\[Transpose]"}], ".", "R"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", "\[Transpose]"}], ".", "M"}], ")"}]}], "//", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixForm", "@", "#"}], ";"}], ",", 
      RowBox[{"MatrixRank", "@", "#"}], ",", 
      RowBox[{"MatrixRank", "[", "S", "]"}]}], "}"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.871109202462373*^9, 3.871109511788019*^9}, {
   3.8711095477257357`*^9, 3.871109738697453*^9}, {3.871109770835149*^9, 
   3.8711098100357323`*^9}, {3.871109849091323*^9, 3.8711098949442*^9}, {
   3.871109946687943*^9, 3.87111012460314*^9}, {3.871110324299809*^9, 
   3.871110346265368*^9}, {3.8711103785674543`*^9, 3.871110378770693*^9}, {
   3.8711104296622143`*^9, 3.871110459223899*^9}, {3.871110495461472*^9, 
   3.871110507471349*^9}, {3.871110546530167*^9, 3.871110629711219*^9}, {
   3.871110698469371*^9, 3.871110854123847*^9}, {3.871110932931163*^9, 
   3.871110944972402*^9}, 3.871111041336892*^9, 3.8711111204495907`*^9, {
   3.8711119439555197`*^9, 3.8711122688520823`*^9}, {3.871112308160725*^9, 
   3.871112330865389*^9}, {3.871112362659526*^9, 3.871112404321205*^9}, {
   3.871112464725103*^9, 3.871112465085753*^9}, {3.8711125783363447`*^9, 
   3.8711125880805607`*^9}, {3.871112621849222*^9, 3.8711126475890903`*^9}, {
   3.871112879429016*^9, 3.8711129226618233`*^9}, {3.871113841285578*^9, 
   3.871113862911768*^9}, {3.871113902602421*^9, 3.871114056669088*^9}, {
   3.87111410036197*^9, 3.871114140182064*^9}, {3.87111418582545*^9, 
   3.8711142631031933`*^9}, {3.871114600571416*^9, 3.8711146037545424`*^9}, {
   3.8711147719243917`*^9, 3.8711148161714563`*^9}, {3.871114896380004*^9, 
   3.8711149399498787`*^9}, 3.871114973640586*^9, {3.8711150788660316`*^9, 
   3.871115097437146*^9}, {3.871115242809486*^9, 3.871115295109847*^9}, {
   3.871115332816062*^9, 3.8711153827125998`*^9}, {3.871115421522592*^9, 
   3.8711154359516087`*^9}, {3.871115473443287*^9, 3.871115505870756*^9}, {
   3.8711155379428797`*^9, 3.871115563602203*^9}, {3.871115678046191*^9, 
   3.871115765829039*^9}, {3.871115856742374*^9, 3.8711158686666594`*^9}, {
   3.87111593051753*^9, 3.8711160443585253`*^9}, {3.871116094140687*^9, 
   3.871116115673464*^9}},
 CellLabel->
  "In[1540]:=",ExpressionUUID->"42c76695-42c2-4ecb-a5fa-c48192d5cd4a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "0", "0"},
     {"0", "0", "1", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8711105436857357`*^9, 3.871110549884615*^9}, {
   3.871110589618909*^9, 3.8711105972124853`*^9}, 3.8711106310192537`*^9, {
   3.871110719613744*^9, 3.871110854697571*^9}, {3.871110933555222*^9, 
   3.871110945329625*^9}, 3.871111041944923*^9, 3.871111120837617*^9, {
   3.8711119534803047`*^9, 3.8711121528883257`*^9}, {3.871112189950859*^9, 
   3.871112215785015*^9}, {3.871112253818852*^9, 3.871112269659849*^9}, {
   3.871112308680008*^9, 3.871112331237792*^9}, {3.871112386264673*^9, 
   3.8711124047221537`*^9}, 3.871112466054625*^9, {3.871112582727833*^9, 
   3.8711125885552883`*^9}, {3.871112623230174*^9, 3.871112648454666*^9}, {
   3.871112908991912*^9, 3.871112923359111*^9}, {3.8711138242496758`*^9, 
   3.871113863405511*^9}, {3.871113902995192*^9, 3.8711139126738443`*^9}, {
   3.8711139600724707`*^9, 3.871114057184505*^9}, {3.871114101470009*^9, 
   3.8711141407062674`*^9}, {3.87111418954812*^9, 3.8711141978378067`*^9}, {
   3.871114233186696*^9, 3.871114263755715*^9}, {3.871114601232638*^9, 
   3.871114604093483*^9}, {3.8711147722660513`*^9, 3.8711148167984753`*^9}, {
   3.871115423999282*^9, 3.871115436930088*^9}, {3.871115474008231*^9, 
   3.8711155064959173`*^9}, {3.871115538452033*^9, 3.871115564064788*^9}, 
   3.8711156787749777`*^9, {3.8711157186518373`*^9, 3.871115766710133*^9}, {
   3.8711158575906897`*^9, 3.871115869835125*^9}, {3.871115933728897*^9, 
   3.871116045096574*^9}, {3.871116102609089*^9, 3.8711161164175873`*^9}},
 CellLabel->
  "Out[1541]//MatrixForm=",ExpressionUUID->"1d10e88e-dc6b-492f-84a9-\
8e7d96afe6e2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "0", "0"},
     {"1", "1", "0", "0"},
     {"0", "0", "1", "1"},
     {"0", "0", "1", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8711105436857357`*^9, 3.871110549884615*^9}, {
   3.871110589618909*^9, 3.8711105972124853`*^9}, 3.8711106310192537`*^9, {
   3.871110719613744*^9, 3.871110854697571*^9}, {3.871110933555222*^9, 
   3.871110945329625*^9}, 3.871111041944923*^9, 3.871111120837617*^9, {
   3.8711119534803047`*^9, 3.8711121528883257`*^9}, {3.871112189950859*^9, 
   3.871112215785015*^9}, {3.871112253818852*^9, 3.871112269659849*^9}, {
   3.871112308680008*^9, 3.871112331237792*^9}, {3.871112386264673*^9, 
   3.8711124047221537`*^9}, 3.871112466054625*^9, {3.871112582727833*^9, 
   3.8711125885552883`*^9}, {3.871112623230174*^9, 3.871112648454666*^9}, {
   3.871112908991912*^9, 3.871112923359111*^9}, {3.8711138242496758`*^9, 
   3.871113863405511*^9}, {3.871113902995192*^9, 3.8711139126738443`*^9}, {
   3.8711139600724707`*^9, 3.871114057184505*^9}, {3.871114101470009*^9, 
   3.8711141407062674`*^9}, {3.87111418954812*^9, 3.8711141978378067`*^9}, {
   3.871114233186696*^9, 3.871114263755715*^9}, {3.871114601232638*^9, 
   3.871114604093483*^9}, {3.8711147722660513`*^9, 3.8711148167984753`*^9}, {
   3.871115423999282*^9, 3.871115436930088*^9}, {3.871115474008231*^9, 
   3.8711155064959173`*^9}, {3.871115538452033*^9, 3.871115564064788*^9}, 
   3.8711156787749777`*^9, {3.8711157186518373`*^9, 3.871115766710133*^9}, {
   3.8711158575906897`*^9, 3.871115869835125*^9}, {3.871115933728897*^9, 
   3.871116045096574*^9}, {3.871116102609089*^9, 3.871116116426772*^9}},
 CellLabel->
  "Out[1542]//MatrixForm=",ExpressionUUID->"4834caf0-a8f1-479c-8db9-\
b93c20f5f31c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.8711105436857357`*^9, 3.871110549884615*^9}, {
   3.871110589618909*^9, 3.8711105972124853`*^9}, 3.8711106310192537`*^9, {
   3.871110719613744*^9, 3.871110854697571*^9}, {3.871110933555222*^9, 
   3.871110945329625*^9}, 3.871111041944923*^9, 3.871111120837617*^9, {
   3.8711119534803047`*^9, 3.8711121528883257`*^9}, {3.871112189950859*^9, 
   3.871112215785015*^9}, {3.871112253818852*^9, 3.871112269659849*^9}, {
   3.871112308680008*^9, 3.871112331237792*^9}, {3.871112386264673*^9, 
   3.8711124047221537`*^9}, 3.871112466054625*^9, {3.871112582727833*^9, 
   3.8711125885552883`*^9}, {3.871112623230174*^9, 3.871112648454666*^9}, {
   3.871112908991912*^9, 3.871112923359111*^9}, {3.8711138242496758`*^9, 
   3.871113863405511*^9}, {3.871113902995192*^9, 3.8711139126738443`*^9}, {
   3.8711139600724707`*^9, 3.871114057184505*^9}, {3.871114101470009*^9, 
   3.8711141407062674`*^9}, {3.87111418954812*^9, 3.8711141978378067`*^9}, {
   3.871114233186696*^9, 3.871114263755715*^9}, {3.871114601232638*^9, 
   3.871114604093483*^9}, {3.8711147722660513`*^9, 3.8711148167984753`*^9}, {
   3.871115423999282*^9, 3.871115436930088*^9}, {3.871115474008231*^9, 
   3.8711155064959173`*^9}, {3.871115538452033*^9, 3.871115564064788*^9}, 
   3.8711156787749777`*^9, {3.8711157186518373`*^9, 3.871115766710133*^9}, {
   3.8711158575906897`*^9, 3.871115869835125*^9}, {3.871115933728897*^9, 
   3.871116045096574*^9}, {3.871116102609089*^9, 3.871116116436248*^9}},
 CellLabel->
  "Out[1546]=",ExpressionUUID->"554ea8f5-4360-4dd1-bbb1-ba6a95f307aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrimePi", "[", "2", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->
  "In[1069]:=",ExpressionUUID->"0599e901-107b-4e10-ac40-1883ca8acf57"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.871114242484315*^9},
 CellLabel->
  "Out[1069]=",ExpressionUUID->"8062dc10-7412-4a18-8131-093ea14463c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"a", "*", "R"}], ",", 
    RowBox[{"b", "*", "R"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.871110153689756*^9, 3.8711101937257767`*^9}, {
  3.871110237948165*^9, 3.871110266525852*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"920fdac7-7d27-4816-a3ef-ec901b3a8d14"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "a", "a", "a"},
     {"0", "0", "a", "0"},
     {"b", "b", "b", "b"},
     {"0", "0", "b", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.871110172629632*^9, 3.871110208920003*^9}, {
  3.8711102405792913`*^9, 3.871110266946157*^9}},
 CellLabel->
  "Out[291]//MatrixForm=",ExpressionUUID->"758a21a3-6efa-4883-9aa2-\
2936db00b128"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.871110172629632*^9, 3.871110208920003*^9}, {
  3.8711102405792913`*^9, 3.87111026695046*^9}},
 CellLabel->
  "Out[292]=",ExpressionUUID->"39a1f166-5082-4217-be8b-c493dd9b502f"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8711096731249523`*^9, 
  3.87110967413728*^9}},ExpressionUUID->"57da32b1-8068-4973-b48b-\
5c25f064b704"]
},
WindowSize->{706.5, 762.},
WindowMargins->{{9, Automatic}, {Automatic, 9}},
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1153685e-36bd-419a-a0d9-c76a306488a5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4782, 120, 336, "Input",ExpressionUUID->"42c76695-42c2-4ecb-a5fa-c48192d5cd4a"],
Cell[5365, 144, 2085, 38, 62, "Output",ExpressionUUID->"1d10e88e-dc6b-492f-84a9-8e7d96afe6e2"],
Cell[7453, 184, 2137, 40, 97, "Output",ExpressionUUID->"4834caf0-a8f1-479c-8db9-b93c20f5f31c"],
Cell[9593, 226, 1653, 24, 48, "Output",ExpressionUUID->"554ea8f5-4360-4dd1-bbb1-ba6a95f307aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11283, 255, 165, 4, 44, "Input",ExpressionUUID->"0599e901-107b-4e10-ac40-1883ca8acf57"],
Cell[11451, 261, 154, 3, 48, "Output",ExpressionUUID->"8062dc10-7412-4a18-8131-093ea14463c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11642, 269, 433, 11, 51, "Input",ExpressionUUID->"920fdac7-7d27-4816-a3ef-ec901b3a8d14"],
Cell[12078, 282, 770, 22, 97, "Output",ExpressionUUID->"758a21a3-6efa-4883-9aa2-2936db00b128"],
Cell[12851, 306, 227, 4, 48, "Output",ExpressionUUID->"39a1f166-5082-4217-be8b-c493dd9b502f"]
}, Open  ]],
Cell[13093, 313, 153, 3, 29, "Input",ExpressionUUID->"57da32b1-8068-4973-b48b-5c25f064b704"]
}
]
*)

